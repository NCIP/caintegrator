<!-- *********************************************************************** -->
<!-- ** SCTR DELEGATING BUILD FILE FOR CRUISECONTROL                      ** -->
<!-- *********************************************************************** -->

<project name="caintegrator2-cruisecontrol" default="continuous-integration" basedir="../..">

    <property name="build.dir" value="${basedir}/software/build" />
    <property name="lib.dir" value="${basedir}/software/lib" />

    <property file="${build.dir}/local.properties" />
    
    <property name="svnant.jar" value="${lib.dir}/svnant.jar" />
    <property name="svnClientAdapter.jar" value="${lib.dir}/svnClientAdapter.jar" />
    <property name="svnjavahl.jar" value="${lib.dir}/svnjavahl.jar" />

	<path id="project.classpath">
	    <pathelement location="${svnjavahl.jar}" /> 
	    <pathelement location="${svnant.jar}" />
	    <pathelement location="${svnClientAdapter.jar}" />
	</path>

    <taskdef resource="svntask.properties" classpathref="project.classpath"/>
    
    <target name="continuous-integration">
        <svn username="${svn.username}" password="${svn.password}">
            <update dir="${basedir}" />
        </svn>
        <copy tofile="${basedir}/../../config.xml" file="software/build/cruisecontrol-config.xml" />
        <ant antfile="build.xml"
            dir="software/build"
            target="continuous-integration" />
        <svn username="${svn.username}" password="${svn.password}">
            <copy message="Tagging with ${label}"
                srcurl="http://gforge.nci.nih.gov/svnroot/caintegrator2/trunk"
                desturl="http://gforge.nci.nih.gov/svnroot/caintegrator2/tags/continuous-integration/${label}" />
        </svn>
    </target>
    
    <target name="nightly-build">
        <svn username="${svn.username}" password="${svn.password}">
            <update dir="${basedir}" />
        </svn>
        <copy tofile="${basedir}/../../config.xml" file="software/build/cruisecontrol-config.xml" />
        <ant antfile="build.xml"
            dir="software/build"
            target="nightly-build" />
        <svn username="${svn.username}" password="${svn.password}">
            <copy message="Tagging with ${label}"
                srcurl="http://gforge.nci.nih.gov/svnroot/caintegrator2/trunk"
                desturl="http://gforge.nci.nih.gov/svnroot/caintegrator2/tags/nightly/${label}" />
        </svn>
    </target>

</project>